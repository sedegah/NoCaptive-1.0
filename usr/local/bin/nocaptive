"""
nocaptive - A simple captive portal detection tool for the terminal.

Usage:
    nocaptive                # Runs with default site
    nocaptive http://site    # Checks a custom HTTP site

Author:
    Kimathi Sedegah
GitHub:
    https://github.com/sedegah
"""

import sys
import requests

DEFAULT_URL = "http://neverssl.com"
EXPECTED_PHRASE = "NeverSSL"  


def check_captive_portal(url):
    try:
        r = requests.get(url, timeout=5)
        if EXPECTED_PHRASE.lower() in r.text.lower():
            print("\033[92m[OK] No captive portal detected.\033[0m")
            return 0
        else:
            print("\033[93m[!] Possible captive portal detected. Content mismatch.\033[0m")
            return 1
    except requests.exceptions.RequestException as e:
        print(f"\033[91m[ERROR] Could not reach {url}: {e}\033[0m")
        return 2


def main():
    url = sys.argv[1] if len(sys.argv) > 1 else DEFAULT_URL
    sys.exit(check_captive_portal(url))


if __name__ == "__main__":
    main()
